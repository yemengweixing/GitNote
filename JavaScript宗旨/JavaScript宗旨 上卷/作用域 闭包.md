---
title: 作用域 闭包
tags: 作用域,闭包,小书匠
grammar_cjkRuby: true
---
# 作用域
作用域是指程序源代码中定义变量的区域。
作用域是在运行时代码中的某些特定部分中变量,函数和对象的可访问性。换句话说,作用域决定了代码区块中变量和其他资源的可见性
也就是确定当前执行代码对变量的访问权限。

JavaScript为词法作用域(lexical scoping)静态作用域 而与词法作用域相对的是动态作用域，函数的作用域是在函数调用的时候才决定的
ES6 之前 JS 没有块级作用域。例如
ES6 中开始加入了块级作用域，使用let定义变量 const定义常量 即可

函数的作用域基于函数创建的位置

var 全局可见   上级可以访问

let 当前块级可见    上级不可访问

const 当前块级可见    上级不可访问

函数  当前块级可见  上级不可访问


自由变量 。如下代码中，console.log(a)要得到a变量，但是在当前的作用域中没有定义a（可对比一下b）。当前作用域没有定义的变量，这成为 自由变量 。自由变量如何得到 —— 向父级作用域寻找。
如果父级也没呢？再一层一层向上寻找，直到找到全局作用域还是没找到，就宣布放弃。这种一层一层的关系，就是 作用域链 。















**闭包**，指那些能够访问自由变量的函数。
**自由变量**是指在函数中使用的，但既不是函数参数也不是函数的局部变量的变量
闭包 = 函数 + 函数能够访问的自由变量


我的理解
一个函数 定义了局部变量 并且返回一个引用了父函数的变量的子函数
1外部环境 调用了函数 访问到了 函数定义的内部变量(或者改变其数值)
2函数返回子函数 并且因为子函数访问了父函数的变量 所以在子函数执行完之前 其父函数的执行上下文一直存在

返回闭包时牢记的一点就是：返回函数不要引用任何循环变量，或者后续会发生变化的变量

闭包就是携带状态的函数，并且它的状态可以完全对外隐藏起来。---- 廖雪峰




闭包就是由函数创造的一个词法作用域，里面创建的变量被引用后，可以在这个词法环境之外自由使用。（ https://secure.wikimedia.org/wikipedia/zh/w/index.php?title=%E9%97%AD%E5%8C%85_%28%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%29&variant=zh-cn ）闭包通常用来创建内部变量，使得这些变量不能被外部随意修改，同时又可以通过指定的函数接口来操作。




